---
sidebar_position: 3
---

# 不同分发方案的费用分析


##  OSS+CDN 

OSS+CDN, 最简单粗暴且行之有效的方法了,  可用性也毫无质疑, 速度也非常低快, 而且完全不用自己维护。如果有足够的经费，这是最优的选择方案。然而，即使是用流量计费的方式, 买优惠的流量包, 流量的成本依然不会低于150元/TB


OSS+CDN, 费用来自于OSS和CDN两个方面。

![](https://ae01.alicdn.com/kf/Ud30624d44d974f8d92c2cf41a4f9a18by.jpg)

### OSS

在OSS方面, 费用包括: 储存费用, 请求费用, CDN回源费用。

储存费用和请求费用几乎可以忽略不计, 前者的价格是5元/40GB/6个月, 后者的价格是0.01元/万次, 40GB的储存对目前来说绰绰有余, 从2020.9.1到2020.9.10的请求次数大约110万次也不过1.1元。相比之下，CDN回源费用大约是0.15元/GB。假设每天回源20GB, 那么一个月的费用将是90元, 即使设置了很长的文件缓存时间, 每次请求也都是会有很大概率回源, 因为某里云CDN节点太多, 我们的用户太少。

### CDN

有了OSS之所以还选择CDN，是因为直接从OSS出的流量费用是贵于OSS+CDN的费用的。

在CDN的方面，费用包括: HTTPS请求费用，流量费用。

前者可以忽略不计，后者在购买到足够优惠的流量包后成本可以降到0.1-0.15元/GB， 但面对指数增长的deb分发流量需求，依旧是难以抗衡。

## 多个5M服务器

![](https://ae01.alicdn.com/kf/U15b2a02f9f254fcdac7b5f1ddd7becear.jpg)

多个5M服务的叠加， 是一种取巧的办法了。经费的缺乏很大程度上是因为我们是学生，这一解决方案的也只有我们这么多学生才能做到。这一方案的主要措施在于：内网反向代理+DNS解析均衡

多个5M，顾名思义，就是用多个5M来作为流量的出口，大气的某里云给了5M的学生机优惠，公网流量也完全用不完, 而OSS从内网流入到服务器是并不耗费流量费用的，仅有微不足道的请求费用，因此用与OSS同一地域的服务器从内网反向代理OSS生成的静态页面和deb资源(或者用ossfs挂在到本地，挂nginx，但内网反代更好)

一般而言，5M的下载速度(660kb/s)已经到达了一般下载站的单人下载速度，使用多个5M的意义在于解决并发的问题，这一目的的实现在用使用DNS对多个5M的ip实现解析均衡，以实现带宽均衡。目前而言，至少需要5个5M，而计划是10个5M。

除去很少的OSS储存费用，请求费用之外，此方案的纯费用约为50元/5台/月, 100元/10台/月。速度不会大打折扣，流量也完全有保障。一旦实现[并发多ip多线程下载](https://gitee.com/deepin-community-store/spark-store/issues/I1UXVA), 速度则会有显著突破.


## 多个5M服务器 + CDN

![](https://ae01.alicdn.com/kf/Ub6e76502a4bb438490a7817db206f96eO.jpg)

如果经费进一步增加， 在完善了10个5M的基本需求后，多个5M集群套一层CDN，形成一条新的线路, 会有一定的加速效果。

使用CDN后的速度：在没有边缘节点缓存时是正常的5M的速度，在有缓存时则是CDN节点的超高速度。


## 总结

|项目|多个5M|多个5M+CDN|OSS+CDN|
|:-:|:-:|:-:|:-:|
|费用|很便宜|略贵|虽然已经很实惠了,但还是负担不起|
|速度|可以接受|CDN节点有缓存就非常快|超级快|
|维护成本|一般|一般|几乎没有|
|统计可视化|要借助于第三方,目前是[CDNplus](https://www.cdnplus.cn/)|至少两个统计出口,容易混淆|很方便|
